Позанимаемся анализом биржевых котировок.

У вас есть таблица StockQuotes(company TEXT, week INT, share_price INT).
Строка в этой таблице говорит о том, что стоимость акции компании company в неделю номер week составляла share_price.

Назовём индексом в данную неделю среднее арифметическое роста стоимости одной акции по всем компаниям сравнительно с предыдущей неделей.
То есть, если одна акция компании A подорожала на 100 единиц, а акция компании B подешевела на 50 единиц, то индекс равен 25.

Назовём компанию успешной на этой неделе, если изменение стоимости одной её акции было выше индекса.
"Изменение D выше индекса I" означает "D > I" как вещественное число.

Если компания была успешной три недели подряд то будем говорить, что она сделала успешную серию.
Успешные серии могут пересекаться. Так, если компания была успешной 5 недель подряд, то у неё было 3 успешных серии.

Вам нужно посчитать для каждой компании количество успешных серий и вывести в результат два столбца.
В первом столбце с типом TEXT должно быть название компании, а во втором с типом BIGINT количество её успешных серий.

Компании, у которых не было успешных серий, выводить в результат не надо совсем.
Все компании различные.
Все цены положительные.
Нумерация недель начинается с 0.
На неделе номер 0, разумеется, не определены рост и индекс
 -- вы можете считать что они 0, NULL или просто игнорировать нулевую неделю тем или иным способом при расчёте успешных недель.

Пример валидного, но неправильного ответа:

SELECT 'Foo'::TEXT, 0::BIGINT